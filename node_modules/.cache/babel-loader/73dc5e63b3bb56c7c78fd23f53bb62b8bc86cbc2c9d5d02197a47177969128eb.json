{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate,Link}from\"react-router-dom\";import AuthPage from\"./components/AuthPage\";import UploadCSV from\"./components/UploadCSV\";import AgentLists from\"./components/AgentLists\";import AddAgent from\"./components/AppAgent\";// Ensure this is AddAgent.js\nimport'./style.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem(\"token\")||\"\");const[agents,setAgents]=useState([]);useEffect(()=>{if(token&&!user){fetchUser();fetchAgents();}},[token]);const fetchUser=async()=>{try{const res=await fetch(\"https://skillhub-backend-m6he.onrender.com/api/auth/me\",{headers:{Authorization:\"Bearer \".concat(token)}});const data=await res.json();setUser(data);}catch(err){console.error(\"Failed to fetch user\",err);handleLogout();}};const fetchAgents=async()=>{try{const res=await fetch(\"https://skillhub-backend-m6he.onrender.com/api/agents\",{headers:{Authorization:\"Bearer \".concat(token)}});const data=await res.json();setAgents(data);}catch(err){console.error(\"Failed to fetch agents\",err);}};const handleLogout=()=>{setUser(null);setToken(\"\");localStorage.removeItem(\"token\");};return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{children:[user&&/*#__PURE__*/_jsxs(\"div\",{className:\"top-bar\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Welcome, \",user.name]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"})]}),user&&/*#__PURE__*/_jsxs(\"nav\",{className:\"nav-bar\",children:[/*#__PURE__*/_jsx(Link,{to:\"/add-agent\",children:\"Add Agent\"}),/*#__PURE__*/_jsx(Link,{to:\"/upload\",children:\"Upload CSV\"}),/*#__PURE__*/_jsx(Link,{to:\"/agents\",children:\"All Agents\"})]}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/upload\"}):/*#__PURE__*/_jsx(AuthPage,{setUser:setUser,setToken:setToken})}),/*#__PURE__*/_jsx(Route,{path:\"/add-agent\",element:user?/*#__PURE__*/_jsx(AddAgent,{token:token}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/upload\",element:user?/*#__PURE__*/_jsx(UploadCSV,{token:token}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/agents\",element:user?/*#__PURE__*/_jsx(AgentLists,{token:token}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/agent/:id\",element:user?/*#__PURE__*/_jsx(AgentLists,{token:token}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Router","Routes","Route","Navigate","Link","AuthPage","UploadCSV","AgentLists","AddAgent","jsxs","_jsxs","jsx","_jsx","App","user","setUser","token","setToken","localStorage","getItem","agents","setAgents","fetchUser","fetchAgents","res","fetch","headers","Authorization","concat","data","json","err","console","error","handleLogout","removeItem","children","className","name","onClick","to","path","element"],"sources":["C:/Users/HP/Desktop/skillhub-frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { BrowserRouter as Router, Routes, Route, Navigate, Link } from \"react-router-dom\";\nimport AuthPage from \"./components/AuthPage\";\nimport UploadCSV from \"./components/UploadCSV\";\nimport AgentLists from \"./components/AgentLists\";\nimport AddAgent from \"./components/AppAgent\"; // Ensure this is AddAgent.js\nimport './style.css';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem(\"token\") || \"\");\n  const [agents, setAgents] = useState([]);\n\n  useEffect(() => {\n    if (token && !user) {\n      fetchUser();\n      fetchAgents();\n    }\n  }, [token]);\n\n  const fetchUser = async () => {\n    try {\n      const res = await fetch(\"https://skillhub-backend-m6he.onrender.com/api/auth/me\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setUser(data);\n    } catch (err) {\n      console.error(\"Failed to fetch user\", err);\n      handleLogout();\n    }\n  };\n\n  const fetchAgents = async () => {\n    try {\n      const res = await fetch(\"https://skillhub-backend-m6he.onrender.com/api/agents\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      setAgents(data);\n    } catch (err) {\n      console.error(\"Failed to fetch agents\", err);\n    }\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    setToken(\"\");\n    localStorage.removeItem(\"token\");\n  };\n\n  return (\n    <Router>\n      <div>\n        {/* Top bar */}\n        {user && (\n          <div className=\"top-bar\">\n            <span>Welcome, {user.name}</span>\n            <button onClick={handleLogout}>Logout</button>\n          </div>\n        )}\n\n        {/* Navigation */}\n        {user && (\n          <nav className=\"nav-bar\">\n            <Link to=\"/add-agent\">Add Agent</Link>\n            <Link to=\"/upload\">Upload CSV</Link>\n            <Link to=\"/agents\">All Agents</Link>\n          </nav>\n        )}\n\n        {/* Routes */}\n        <Routes>\n          <Route\n            path=\"/\"\n            element={user ? <Navigate to=\"/upload\" /> : <AuthPage setUser={setUser} setToken={setToken} />}\n          />\n          <Route\n            path=\"/add-agent\"\n            element={user ? <AddAgent token={token} /> : <Navigate to=\"/\" />}\n          />\n          <Route\n            path=\"/upload\"\n            element={user ? <UploadCSV token={token} /> : <Navigate to=\"/\" />}\n          />\n          <Route\n            path=\"/agents\"\n            element={user ? <AgentLists token={token} /> : <Navigate to=\"/\" />}\n          />\n          <Route\n            path=\"/agent/:id\"\n            element={user ? <AgentLists token={token} /> : <Navigate to=\"/\" />}\n          />\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\n        </Routes>\n      </div>\n    </Router>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}